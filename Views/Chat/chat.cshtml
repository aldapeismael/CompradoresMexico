@{
    Page.Title = "Publicación";

    int IntPopUp = int.Parse(Request.QueryString["Popup"]?.ToString() ?? "0");
    if (IntPopUp == 0)
    {
        Layout = "~/_SiteLayout.cshtml";
    }
    int IntIdPublicacion = int.Parse(Request.QueryString["IdPublicacion"]?.ToString() ?? "0");

    ObjetoBusqueda objetoBusqueda = new ObjetoBusqueda();
    objetoBusqueda.IntEjecuta = 0;
    objetoBusqueda.IntId1 = IntIdPublicacion;
    if (IntIdPublicacion == 0)
    {
        Response.Redirect("~/Views/Default/Default.cshtml");
    }
    var lstObjPublicacion = new Publicacion().ObtenerListaGenerica(objetoBusqueda);
    Publicacion objPublicacion = new Publicacion();
    if (lstObjPublicacion.Count > 0)
    {
        objPublicacion = lstObjPublicacion.First();
    }
    int i = 0;



}
<link rel="stylesheet" href="@VariableGlobal.StrUrlSitio/css/productDetail.css">
<div class="ContactModal modalChatMensaje" id="ContactModal" data-idpublicacion="@objPublicacion.IntIdPublicacion">
    <div class="containerForm">
        @*<div class="containerNav">
                <h2>Contactar</h2>
                <div id="ContactModalClose">
                    <i class="material-icons md-48">clear</i>
                </div>
            </div>*@
        <hr>
        <div class="row containerProfile">
            <div class="col-2 profile">
                <img src="@VariableGlobal.StrUrlSitio/img/dummy.jpg" width="50px">
            </div>
            <div class="col-8 user">
                <div>
                    <p class="user">
                        @objPublicacion.StrCveComprador
                    </p>
                </div>
                <div>
                    <p class="userDetail">
                        <span>
                        </span>
                    </p>
                </div>
            </div>
            <div class="col-2 btn">
                @*<i class="material-icons md-48">call</i>*@
            </div>
        </div>
        <hr>
        <div class="row containerProduct">
            <div class="col-10">
                <p class="productName">@objPublicacion.StrDescCategoria</p>
                <p class="productDesc">@objPublicacion.StrCveCategoria</p>
            </div>
            <div class="col-2">
                <p class="productCost">
                    $@objPublicacion.DecPresupuesto.ToString("#,###,###.##")
                </p>
            </div>
            <img src="@VariableGlobal.StrUrlSitio/Views/Publicacion/PublicacionImagen/@objPublicacion.StrNombreArchivo" class="" alt="">
            <div id="chatbox" style="overflow-y: scroll; height: 100px; max-height: 100px"></div>
            <div class="row containerChat">
                <div class="col-10">
                    <input type="text" placeholder="Escribe tu mensaje" name="" id="txt_MensajeEnvio">
                </div>
                <div class="col-2">
                    <button id="btn_EnviaMensaje" class="rounded-circle">
                        >
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $("#btn_EnviaMensaje").click(function () {
        fn_EnviaMensaje();
    });
    function fn_EnviaMensaje() {
        var strMensajeEnvio = $("#txt_MensajeEnvio").val();
        var obj_Chat = {
            IntIdPublicacion: @objPublicacion.IntIdPublicacion,
            IntIdUsuarioDestino: @objPublicacion.IntIdUsuario,
            StrMensaje: strMensajeEnvio
        }

        var str_Metodo = "";
        var str_Url = "";
        str_Metodo = "POST";
        str_Url = "@VariableGlobal.StrUrlApi/Chat/Post/0/";

        if (strMensajeEnvio.length > 0) {
            $.ajax({
                url: str_Url,
                data: JSON.stringify(obj_Chat),
                type: str_Metodo,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (obj_Datos) {
                    //Se manda el mensaje de exito
                    if (obj_Datos["IntError"] == 1) {
                        toastr[obj_Datos["StrTipoError"]](obj_Datos["StrMensajeError"]);
                    } else {
                            $('#chatbox').append("<strong>" + "@VariableGlobal.SessionStrCveUsuario" + ":</strong> " + strMensajeEnvio + "<br>");
                            var objDiv = document.getElementById("chatbox");
                            objDiv.scrollTop = objDiv.scrollHeight;
                    }
                }
            });
        }
    }
</script>